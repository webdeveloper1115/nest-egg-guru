function toggleNav(t,e,n){$(t).html(n),$(t).attr("href",e)}function toggleSubmit(t,e){return $(t).find("button[type=submit]").attr("disabled",e)}function flashMsg(t){$(t).fadeIn("slow"),$(t+"-text").addClass("error"),$("#contact-form").find(".general-input").val(""),$("#contact-form").find("button[type=submit]").attr("disabled",!1),setTimeout(function(){$(t).fadeOut("slow")},3e3)}function processResults(t){var e=!_.isUndefined(t.accumtable),n=e?_.valuesIn(t.accumtable):t.chartData;determineResultsSummaryDisplay(t.keytable.NumberofYearsinRetirementHorizon),binding(t),e?(D3.line(n),D3.horizontal(n)):(toggleLinks(t.tableHead),D3.vertical(n,!1,!1,!1,t.tableHead.length))}function determineResultsSummaryDisplay(t){var e=[5,10,15,20,25,30,35,40,45,50],n=$("#80thPercentileBalance"),a=$("#LowestBalance");e.forEach(function(e,i){_.isEqual(e,Number(t))&&(n.addClass("80thPercentileBalance"+i),a.addClass("LowestBalance"+i))})}function toggleLinks(t){var e=["5years","10years","15years","20years","25years","30years","35years","40years","45years","50years"];_.forEach(e,function(e,n){$("."+e+"-toggle").toggle(_.has(t[n],e))})}function binding(t){$(".clear-table").html(""),_.forIn(t,function(t,e){$("."+e).html(t),_.forIn(t,function(t,e){$("."+e).html(numberWithCommas(_.isArray(t)?t[0]:t)),_.forEach(t,function(t,n){$("."+n).html(t),$("."+e+n).html(""),$("."+e+n).html(numberWithCommas(t))})})})}function flashErrMsg(t,e){$(t).html("").append(e).fadeIn("slow").delay(5e3).fadeOut()}function postAjax(t,e){var n=$(t).attr("action"),a=$(t).serialize();$.post(n,a).done(function(t){e(t)}).fail(function(t){e(JSON.parse(t))})}function requestedAjax(t,e){var n=$(t).attr("action"),a=$(t).serialize();$("#content").hide(),$(".ajax-loading").show(),$.post(n,a).done(function(t){$("#content").show(),$(".ajax-loading").hide(),$(".tab-title").removeClass("disabled-results"),$("#calculator-results-tab").click(),e(t)}).fail(function(t){e(JSON.parse(t))}).always(function(){console.info("complete")})}function printRequestedAjax(t,e){$.get(t).done(function(t){e(t)}).fail(function(t){e(JSON.parse(t))}).always(function(){console.info("complete")})}$(function(){$(".calculator-form").submit(function(t){$(".graph, .legend").html(""),requestedAjax(this,processResults)}),$("#results-data-path").val()&&($(".page-print .graph").html(""),printRequestedAjax($("#results-data-path").val(),function(t){var e=!_.isUndefined(t.accumtable),n=e?_.valuesIn(t.accumtable):t.chartData;determineResultsSummaryDisplay(t.keytable.NumberofYearsinRetirementHorizon),binding(t),e?(D3.line(n,560,280,65,20),D3.horizontal(n,600,300,65)):(toggleLinks(t.tableHead),D3.vertical(n,580,290,65,t.tableHead.length))})),$("#print-page").click(function(){window.print()}),$(".confirm-payment-form").submit(function(){$(this).find(":submit").attr("disabled","disabled")}),$(".ajax-form").submit(function(t){$(this).find("button").prop("disabled",!0),t.preventDefault(),postAjax(this,function(t){if(binding(t),_.isUndefined(t.modal)||($(t.modal).foundation("reveal","open"),$(".confirm-toggle").remove(),$(".toggle-btns").append('<div class="confirm-toggle confirm-btn" hidden>Are You Sure?</div>'),$(".confirm-toggle").unbind().one("click",function(t){$(this).html("loading..."),$("#submit-form").submit()})),_.isUndefined(t.oldPlan)||$("."+t.oldPlan+"-card, .radio-btns").hide(),_.isUndefined(t.plan)||$("."+t.plan).show(),!_.isUndefined(t.type)){var e=_.isEqual(t.type,"cancel")?"reactivate":"cancel";$("."+t.type+"-subscription").hide(),$(".confirm-toggle").hide(),$("."+t.type+"-toggle").show(),$("#submit-form").attr("action","/user/subscription/"+e)}})}),$("#contact-form").submit(function(t){toggleSubmit(this,!0),postAjax(this,function(t){flashMsg(t)})}),$(".tab-ajax").submit(function(t){var e=this,n=$(e).attr("data");$(e)[0].checkValidity()&&(toggleSubmit(e,!0),postAjax(e,function(t){_.isUndefined(t.userMessage)?($("#next-tab"+n).click(),$("#next-tab2-1").click(),toggleNav(".register-link","/user/logout","logout"),toggleNav(".sign-in-link","/user","My Account")):_.isEqual(t.code,2001)?flashErrMsg(".tab-error","Acccount with that email already exists. Would you like to login?"):flashErrMsg(".tab-error",t.userMessage),_.isEqual(t.code,2001)?$("#login-tab").click():toggleSubmit(e,!1)}))})});